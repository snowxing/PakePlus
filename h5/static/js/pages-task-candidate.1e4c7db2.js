(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-task-candidate"],{"2e55":function(t,a,e){"use strict";var i=e("fc28"),n=e.n(i);n.a},"574c":function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return n})),e.d(a,"a",(function(){}));var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"candidate-add-container"},[t.canvasflag?t._e():e("v-uni-view",{staticClass:"box mt-30"},[e("v-uni-view",{staticClass:"item"},[e("v-person",{attrs:{item:t.candidate},on:{trigger:function(a){arguments[0]=a=t.$handleEvent(a),t.person_trigger.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"item"},[e("v-person",{attrs:{item:t.cc_to},on:{trigger:function(a){arguments[0]=a=t.$handleEvent(a),t.cc_trigger.apply(void 0,arguments)}}})],1),t.showDeadline?e("v-uni-view",{staticClass:"item"},[e("v-date-time",{attrs:{item:t.should_at},on:{trigger:function(a){arguments[0]=a=t.$handleEvent(a),t.should_trigger.apply(void 0,arguments)}}})],1):t._e(),t.showDeadline?e("v-uni-view",{staticClass:"item"},[e("v-date-time",{attrs:{item:t.deadline_at},on:{trigger:function(a){arguments[0]=a=t.$handleEvent(a),t.deadline_trigger.apply(void 0,arguments)}}})],1):t._e()],1),t.canvasflag?e("v-uni-view",{staticClass:"canviewbox"},[e("Candidate",{on:{childtofatherimg:function(a){arguments[0]=a=t.$handleEvent(a),t.fatherimg.apply(void 0,arguments)}}})],1):t._e(),e("v-footer-btn",{attrs:{txt:"提交"},on:{scallback:function(a){arguments[0]=a=t.$handleEvent(a),t.submit.apply(void 0,arguments)}}})],1)},n=[]},6111:function(t,a,e){"use strict";e.r(a);var i=e("fa61"),n=e.n(i);for(var d in i)["default"].indexOf(d)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(d);a["default"]=n.a},"9a86":function(t,a,e){var i=e("c86c");a=i(!1),a.push([t.i,"uni-page-body[data-v-bc1f24ec]{background:#f8f7f6}body.?%PAGE?%[data-v-bc1f24ec]{background:#f8f7f6}.candidate-add-container .box[data-v-bc1f24ec]{background:#fff;width:100%;height:auto;border-bottom:%?1?% solid #f2f2f2}.candidate-add-container .box .item[data-v-bc1f24ec]{border-top:%?1?% solid #f2f2f2}.candidate-add-container .box[data-v-bc1f24ec]{background:#fff;width:100%;height:auto;border-bottom:%?1?% solid #f2f2f2}.candidate-add-container .box .item[data-v-bc1f24ec]{border-top:%?1?% solid #f2f2f2}.name[data-v-bc1f24ec]{line-height:%?80?%;opacity:.8;font-size:16px;height:%?80?%}.canviewbox[data-v-bc1f24ec]{position:fixed;top:0;bottom:0;left:0;right:0;width:100%;height:100%;z-index:999;background:#fff}",""]),t.exports=a},f74f:function(t,a,e){"use strict";e.r(a);var i=e("574c"),n=e("6111");for(var d in n)["default"].indexOf(d)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(d);e("2e55");var o=e("828b"),l=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"bc1f24ec",null,!1,i["a"],void 0);a["default"]=l.exports},fa61:function(t,a,e){"use strict";e("6a54");var i=e("f5bd").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,e("bf0f"),e("2797"),e("aa9c"),e("fd3c"),e("d4b5");var n=i(e("39d8")),d=e("6e31"),o=e("1575"),l=e("4241"),s=i(e("044e")),r=getApp({allowDefault:!0}),u={data:function(){var t;return t={disabledbtn:!0,sign:!1,url:"",canvasflag:!1,img:"",type:0,app_id:0,candidate:{title:"接收人",field:"candidate",props:{multiple:!1},value:[],options:[]},props:{multiple:!1},cc_to:{title:"抄送人",field:"cc",props:{multiple:!0},value:[],options:[]}},(0,n.default)(t,"props",{multiple:!0}),(0,n.default)(t,"should_at",{title:"任务开始时间",field:"should_at",value:d.tool.getCurrentFormatTime(1800),props:{readonly:!1}}),(0,n.default)(t,"props",{readonly:!1}),(0,n.default)(t,"deadline_at",{title:"截至日期",field:"deadline_at",value:d.tool.getCurrentFormatTime(86400),props:{readonly:!1}}),(0,n.default)(t,"props",{readonly:!1}),(0,n.default)(t,"showDeadline",!1),t},components:{Candidate:s.default},mounted:function(){var t=this;window.addEventListener("message",(function(a){t.canvasflag=!1,t.type=a.data.type,a.data.msgs&&(t.img=a.data.msgs,t.submiturl())}))},props:{},onLoad:function(t){var a=r.globalData.formData.candidate,e=r.globalData.formData,i=this.candidate;this.app_id=e.app_id,this.sign=e.sign,(4==e.app_id&&0==e.task_id||9==e.app_id&&0==e.task_id)&&(i.props.multiple=!0,this.setData({candidate:i}));var n=JSON.parse(e.forms_data);1==n[n.length-1].is_time_limit&&this.setData({showDeadline:!0});var d=!1;for(var o in a)a[o].forEach((function(t){i.options.push({id:t.uid,title:t.name,active:!0,note:""}),i.value.push(t.uid),d=!0}));d&&this.setData({candidate:i})},methods:{fatherimg:function(t){this.img=t,this.canvasflag=!1,this.submiturl()},WriteName:function(){this.canvasflag=!this.canvasflag},submiturl:function(){var t=this;l.api.uploader_image({base64_file:this.img},(function(a){t.url=a.data.url}))},cc_trigger:function(t){var a;a=t.detail.value.map((function(t){return t.id})),this.cc_to.value=a},person_trigger:function(t){var a;a=t.detail.value.map((function(t){return t.id})),this.candidate.value=a},should_trigger:function(t){var a=this.should_at;a.value=t.detail.value,this.setData({should_at:a})},deadline_trigger:function(t){var a=this.deadline_at;a.value=t.detail.value,this.setData({deadline_at:a})},submit:function(){var t=this;if(0==this.candidate.value.length)return d.tool.info("必须选择任务接收人");var a=r.globalData.formData,e=a.candidate;for(var i in"string"==typeof e&&"{"==e[0]&&"}"==e[e.length-1]&&(e=JSON.parse(e)),e)e[i]=this.candidate.value;var n="1970-01-01 00:00:00",s="1970-01-01 00:00:00";if(this.showDeadline){if(0==this.deadline_at.value.length||0==this.should_at.value.length)return d.tool.info("必须选择任务开始时间和截至时间");var u=new Date(this.should_at.value+":00").getTime()-(new Date).getTime();if(u<3e5)return d.tool.info("请给任务开始时间预留至少5分钟的时间");if(u=new Date(this.deadline_at.value+":00").getTime()-new Date(this.should_at.value+":00").getTime(),u<3e5)return d.tool.info("请给任务预留至少5分钟的时间");n=this.deadline_at.value,s=this.should_at.value}a.deadline_time=n,a.deadline_start_time=s,a.candidate=JSON.stringify(e),a.notice=JSON.stringify(this.cc_to.value),this.disabledbtn&&(this.disabledbtn=!1,uni.showLoading({title:"提交中请稍后",mask:!0}),l.api.process_launch(a,(function(a){if(uni.hideLoading(),d.tool.clearFormData(t.app_id),void 0!=r.globalData.lstCacheKey&&d.tool.clearFormData(r.globalData.lstCacheKey),203==a.code||200==a.code)o.wxapi.openUrl("/pages/task/list?type="+r.globalData.task_type,2);else if(206==a.code){var e=getCurrentPages()[getCurrentPages().length-1];e.onLoad(e.options)}}),(function(a){console.log(a,"complete"),t.disabledbtn=!0})))}}};a.default=u},fc28:function(t,a,e){var i=e("9a86");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("967d").default;n("4dce1ebd",i,!0,{sourceMap:!1,shadowMode:!1})}}]);